<div class = "afterEventsDiv">

    <div class="event-1 selector" data-id="<%= @afterevent1.id %>">
      <h4 class = "font-ae">Dinner @ Attica</h4>
      <h5 class = "font-ae"><a href="http://www.attica.com.au/#!home"> <img class = "event-page" src="/images/events/attica-logo.png" alt=""></a></h5>
      <h5 class = "font-ae">7pm - 10pm</h5>
      <h5 class = "font-ae"><a class = "font-ae-map" href="/map">74 Glen Eira Rd, Ripponlea 🌏</a></h5>
      <img class = "event-interior" src="/images/events/attica-front.jpg" alt="">
      <button class = "js-attend"> Attend </button>
      <h5> Attendees: <span class = "attendees-count"><%= @attendance1_count %></span></h5>
    </div>

    <div class="event-2 selector" data-id="<%= @afterevent2.id %>">
      <h4 class = "font-ae">Dinner @ Crown</h4>
      <h5 class = "font-ae"><a href="https://www.crownmelbourne.com.au/restaurants/premium/dinner-by-heston-blumenthalWebsite"> <img class = "event-page" src="/images/events/crown-heston-logo.jpg" alt=""></a></h5>
      <h5 class = "font-ae">7pm - 11pm</h5>
      <h5 class = "font-ae"><a class = "font-ae-map" href="/map">130/8 Whiteman St, Southbank 🌏</a></h5>
      <img class = "event-interior" src="/images/events/crown_hest.jpg" alt="">
      <button class = "js-attend"> Attend </button>
      <h5> Attendees: <span class = "attendees-count"><%= @attendance2_count %></span></h5>
    </div>

    <div class="event-3 selector" data-id="<%= @afterevent3.id %>">
      <h4 class = "font-ae">Party @ Bond</h4>
      <h5 class = "font-ae"><a href="http://www.bondmelbourne.com.au/"> <img class = "event-page" src="/images/events/bond_logo.jpg" alt=""></a></h5>
      <h5 class = "font-ae">10pm - up to 6am</h5>
      <h5 class = "font-ae"><a class = "font-ae-map" href="/map">24 Bond St, CBD 🌏</a></h5>
      <img class = "event-interior" src="/images/events/bond3.jpg" alt="">
      <button class = "js-attend"> Attend </button>
      <h5> Attendees: <span class = "attendees-count"><%= @attendance3_count %></span></h5>
    </div>

</div>


<script>
$(document).ready(function() {

  $('.js-attend').on('click', function(event){
    // console.log('you are attending');
    var $afterEventDiv = $(event.target).closest('.selector');
    var aftereventId = $afterEventDiv.data('id');
    var $attendanceCountSpan = $afterEventDiv.find('.attendees-count');
    console.log($attendanceCountSpan);

    $.ajax( {
      url: '/attendances',
      data: {afterevent_id: aftereventId},
      method: 'post'
    } ).done(function(response){
      $attendanceCountSpan.html(response.attendance_count);

    })
  });

})

</script>

<!-- <h2><a href="/map">go to map to see all locations</a></h2> -->
<!-- Please 'like' the event so that we can estimate the number of guests and make reservations -->
